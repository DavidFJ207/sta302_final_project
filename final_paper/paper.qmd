---
title: "STA302 Fall 2024 Final Project Part 1: Research Proposal and Data Introduction"
author: 
- "Wendy Huang"
- "Gadiel David Flores"

date: "04/10/24"
subtitle: "Research Proposal and Data Introduction"
output: pdf_document
format: pdf
number-sections: true
bibliography: references.bib
---

# Work Division

## Group Member 1:
**Main Focus: Research and Data Analysis**

- **Contributions**: 
  - Locate and clean the dataset.
  - Write the **Data Description** section (300 words).
  - Fit the **Multiple Linear Regression Model** and write the **Preliminary Results** section (300 words).
  - Conduct **Residual Analysis** and create the required residual plots.

### Specific Tasks:
1. **Locate the dataset** that fits the project requirements (open-source, contains a response variable and at least 9 predictors).
2. **Clean the data**: Handle missing values, prepare numerical and categorical variables, and ensure it’s ready for regression.
3. **Write the Data Description**:
   - State where the data was found.
   - Describe how the data was originally collected by the curator.
   - Summarize the response variable and justify why it's suitable for linear regression.
   - Summarize the predictor variables, provide numerical/graphical summaries, and interpret the descriptive statistics.
4. **Fit the multiple linear regression model** using R, incorporating at least 5 predictors, including one categorical predictor.
5. **Conduct residual analysis**:
   - Check for violations of linear regression assumptions.
   - Create residual plots and interpret their results.
6. **Write the Preliminary Results**:
   - Report on the fitted model.
   - Discuss model assumptions (whether violated or not).
   - Compare the preliminary model results to findings from the literature (summarized by Group Member 2).

## Group Member 2:
**Main Focus: Research Question, Literature Review, and Report Writing**

- **Contributions**:
  - Write the **Introduction** section (350 words).
  - Conduct the **Literature Review**: Summarize three peer-reviewed academic papers related to the research question.
  - Write the **Ethics Discussion** section (100-200 words).
  - Compile the **Bibliography** and format citations.
  - Final editing and formatting of the proposal.

### Specific Tasks:
1. **Formulate the research question**: Define a clear, focused research question based on the chosen dataset and explain why it’s suitable for linear regression.
2. **Conduct the literature review**:
   - Find and summarize three peer-reviewed academic papers related to the topic.
   - Describe how each paper relates to the proposed research question and supports the use of linear regression.
3. **Write the Introduction**:
   - Introduce the relevance/importance of the research topic.
   - Clearly state the research question.
   - Summarize the results of the three academic papers and explain how they connect to your research.
   - Justify why linear regression is an appropriate tool for this analysis.
4. **Write the Ethics Discussion**: 
   - Assess whether the dataset is trustworthy and ethically collected
5. **Compile the bibliography**:
   - Ensure proper formatting and inclusion of references in the proposal using APA format.
6. **Final editing and formatting**:
   - Review the entire document



# Introduction (350 words)

# Data Description (300 words)

## Data Source

Using data from Statistics Canada, we extracted five datasets. @StatCan-NewHousingPriceIndex served as the foundation for this research paper, as it contained the main statistic we wanted to analyze. @StatCan-NewHousingPriceIndex represents the new housing price index, which calculates the average cost of new housing each month by multiplying by 100 and dividing by the base year. This provides an index reflecting housing costs for any given year and month. We then utilized @StatCan-CPI, @StatCan-GDP, @StatCan-HousingStarts, @StatCan-FinancialMarketStats, and @StatCan-HousingAbsorptions to extract our 13 predictors, including Absorption, GDP, CPI, interest rates, and Construction. Specifically, Absorption and Construction are further divided into two parts. Absorbtion is divided into semi-detached homes and single homes as well as empty and sold houses for any given month. Construction is categorized into three parts: new construction, under construction, and finished construction. These datasets were cleaned by removing missing values, converting data into whole integers, and merging them into one dataset. Additionally, the data spans from 1997 to 2016 and is divided quarterly, providing 76 entries. Lastly, we used interest rates to create our categorical predictor. This was done by comparing the entry i with entry i+1 in order to determine if there was an interest hike.   

## Response and Predictor Variables
Given our research question [TODO: what specific factors have the greatest effect on home prices in Canada]. The response variable chosen to help answer our research question is 'new housing price index'. This variable is suitable for linear regression because it is continuous, enabling us to model its relationships with multiple predictors. Additionally, since the new housing price index is influenced by economic variables, it allows us to identify trends and patterns through our linear regression model. For these reasons, it is a strong candidate for our model. Our five predictor variables are the number of available homes, homes sold, homes starting construction, new homes completed, and rate hikes

# Ethics Discussion (100-200 words)

# Preliminary Results (300 words)

# Residual Analysis
In this section, we will explore the assumptions made for our linear regression models and check for any violations. To begin, using our model in @sec-model, we created residual plots to verify these assumptions. The first graph we will examine is @fig-resid, which is our Residuals vs. Fitted Values plot. This graph shows some clustering around a fitted value of 100 and above the 0 residual line. It also displays a decreasing fanning pattern. These two characteristics suggest potential non-linearity and some correlated errors.

Next, we will review the residuals vs. predictors. In @fig-residuals-3 and @fig-residuals-4 The plots for homes being built and completed homes show the least amount of assumption violations, as the graphs exhibit good spread and randomness. In contrast, the plots for homes sold @fig-residuals-1 and unsold homes @fig-residuals-2 display some fanning and clustering, which may indicate correlated errors and non-constant variance. Our categorical predictor, rate hike @fig-residuals-5 , reveals some non-constant variance, as the spread of residuals for "1" is wider than for "0."

Lastly, while most residuals align well with the line in the QQ plot @fig-qq_plot , there are deviations at the lower and upper extremes, suggesting some skewness. This indicates that the residuals are not perfectly normally distributed, which may signal a violation of the normality assumption.  

## Model Fitting {#sec-model}  

**Data**  
- **Quarterly Average**: This is our response variable, representing the average cost of a home in Canada.  
- **Detached Absorption Quarterly Avg**: This is our first predictor variable, describing the number of houses sold in a quarter.  
- **Starting Detached Construction**:  This predictor variable indicates the number of houses that began construction in a quarter.  
- **Completed Construction Detached**:  This represents the number of homes completed in a given quarter.  
- **Rates**:  This is our categorical predictor, with a value of 1 if there was a rate hike in that quarter or 0 if there was not.  
- **Detached Unabsorbed Quarterly Avg**:  This is our final predictor, indicating the number of available houses that were not sold during that quarter.  

```{r}
#| label: fig-data
#| fig-cap: "Data"
#| echo: false
#| warning: false
#| message: false

library(tidyverse)
library(ggplot2)
library(readr)

# Load the dataset into R
data <- read_csv(here::here("data/analysis_data/analysis_data.csv"))
```

```{r}
#| label: fig-model
#| fig-cap: "Multiple Linear Model"
#| echo: false
#| warning: false
#| message: false

# Fit a multiple linear model
model <- lm(Quarterly_Average ~ Detached_Absorption_Quarterly_Avg + 
              Detached_Unabsorbed_Quarterly_Avg + 
              Starting_Detached_Construction + 
              Completed_Construction_Detached + 
              rates, 
            data = data)
# Extract the model intercept
intercept <- round(as.numeric(coef(model)[1]))
# Display Results
summary(model)
```

```{r}
#| label: fig-resid
#| fig-cap: "Residual vs Fitted Values"
#| echo: false
#| warning: false
#| message: false

# Residual and fitted values for the model
y_value <- resid(model)
x_value <- fitted(model)

# Plot the residual vs fitted values
plot(x = x_value, y = y_value, 
     main = "Residual vs Fitted", 
     xlab = "Fitted", 
     ylab = "Residuals")
```

```{r}
#| label: fig-residuals
#| fig-cap: "Residuals vs Each Predictor"
#| echo: false
#| warning: false
#| message: false

# Set up plot layout: 1 row, 3 columns
par(mfrow = c(1, 1))

# Residual vs Sold Homes
plot(x = data$Detached_Absorption_Quarterly_Avg, y = y_value, 
     main = "Residual vs Sold Homes", 
     xlab = "Sold Homes", ylab = "Residuals")

# Residual vs Unsold Homes
plot(x = data$Detached_Unabsorbed_Quarterly_Avg, y = y_value, 
     main = "Residual vs Unsold Homes", 
     xlab = "Unsold Homes", ylab = "Residuals")

# Residual vs New Homes Being Built
plot(x = data$Starting_Detached_Construction, y = y_value, 
     main = "Residual vs New Homes Being Built", 
     xlab = "New Homes Being Built", ylab = "Residuals")

# Residual vs Homes Completed
plot(x = data$Completed_Construction_Detached, y = y_value, 
     main = "Residual vs Homes Completed", 
     xlab = "Homes Completed", ylab = "Residuals")

# Boxplot of Residuals vs Rate Hike
boxplot(y_value ~ data$rates, 
        main = "Residual vs Rate Hike", 
        xlab = "Rate Hike", ylab = "Residuals")
```

```{r}
#| label: fig-qq_plot
#| fig-cap: "QQ Plot"
#| echo: false
#| warning: false
#| message: false

# Create a QQ plot for residuals
qqnorm(resid(model), main = "Normal QQ Plot of Residuals")
qqline(resid(model))
```

\newpage

# Bibliography  